@{
    ViewData["Title"] = "Mina sidor";
}
@model XArbete.Web.ViewModels.CustomersAdminViewModel
<br />
<br />

<!-- Page Content -->
<div class="container" style="margin-top:100px">

    <div class="row">
        <div class="col-md-12 mb-5">
            <h2>Mina sidor</h2>
            <hr>
            <p>Här kan du granska och ändra dina uppgifter, lägga till/ta bort hundar samt hantera dina bokningar.</p>
        </div>

    </div>
    <div class="row">
        <div class="col-md-4 mb-5">

            <div class="table-wrapper">
                <div class="table-title">
                    <div class="row">
                        <div class="col-sm-12">
                            <h2>Dina uppgifter</h2>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <form asp-controller="Customer" asp-action="UpdateInfo" method="post">
                        <input type="hidden" value="@Model.Customer.ID" asp-for="@Model.Customer.ID" />
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" readonly class="form-control" id="email" value="@Model.Customer.Email">
                        </div>
                        <div class="form-group">
                            <label for="name">Namn</label>
                            <input type="text" class="form-control" id="name" asp-for="@Model.Customer.Name" value="@Model.Customer.Name">
                        </div>
                        <div class="form-group">
                            <label for="phone">Telefon</label>
                            <input type="text" class="form-control" id="phone" asp-for="@Model.Customer.Number" value="@Model.Customer.Number">
                        </div>
                        <div class="form-group">
                            <label for="password">Lösenord</label>
                            <input type="password" class="form-control" id="password" placeholder="New password">
                        </div>
                        <button type="submit" class="btn btn-primary">Spara</button>
                    </form>
                </div>
            </div>
         
        </div>
        <div class="col-md-8 mb-5">



            <div class="table-wrapper">
                <div class="table-title">
                    <div class="row">
                        <div class="col-sm-6">
                            <h2>Dina hundar</h2>

                        </div>
                        <div class="col-sm-6">
                            <a href="#addDog" class="btn btn-success" data-toggle="modal"><i class="material-icons">&#xE147;</i> <span>Lägg till ny</span></a>
                        </div>
                    </div>
                </div>
                <table class="table table-striped table-hover table-sm">
                    <thead>
                        <tr>
                            <th scope="col">ID</th>
                            <th scope="col">Namn</th>
                            <th scope="col">Ras</th>
                            <th scope="col">Kön</th>
                            <th scope="col">Kastrerad</th>
                            <th scope="col">Bo med andra</th>
                            <th scope="col">Övrigt</th>

                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var dog in Model.Dogs)
                        {
                            <tr>
                                <th scope="row">@dog.ID</th>
                                <td>@dog.Name</td>
                                <td>@dog.Ras</td>
                                <td>@dog.Sex</td>
                                <td>@dog.Kastrated</td>
                                <td>@dog.CanLiveWithOtherDogs</td>
                                <td>@dog.Other</td>
                                <td><a href="#deleteCustomerDog" data-toggle="modal" data-id="@dog.ID"><i class="fa fa-trash" aria-hidden="true"></i></a></td>
                            </tr>

                        }
                    </tbody>
                    
                </table>
            </div>


















        </div>
    </div>
    <div class="row">
        <div class="col-md-12 mb-5">

            <div class="table-wrapper">
                <div class="table-title">
                    <div class="row">
                        <div class="col-sm-6">
                            <h2><b>Dina bokningar</b></h2>
                        </div>
                        <div class="col-sm-6">
                        </div>
                    </div>
                </div>
                <table class="table table-striped table-hover">



                    <!-- HUNDPENSIONAT BOKNINGAR -->
                    <thead>
                        <tr></tr>
                        <tr>
                            <th><h5>Hundpensionat</h5></th>
                        </tr>
                    </thead>
                    <thead>
                        <tr>
                            <th>Bokningsnummer</th>
                            <th>HundID</th>
                            <th>Från</th>
                            <th>Till</th>
                            <th>Meddelande</th>
                            <th>Träning</th>
                            <th>Grooming</th>
                            <th>Extra promenad</th>
                            <th>Summa</th>

                        </tr>
                    </thead>
                    <tbody>

                        @foreach (var booking in Model.HotelBookings.Where(a => a.To >= DateTime.Now))
                        {
                            <tr>
                                <td>@booking.ID</td>
                                <td>@booking.DogID</td>
                                <td>@booking.From.ToString("yyyy-MM-dd HH:mm")</td>
                                <td>@booking.To.ToString("yyyy-MM-dd HH:mm")</td>
                                <td>@booking.CustomerMessage</td>
                                <td>@booking.Training</td>
                                <td>@booking.Grooming</td>
                                <td>@booking.ExtraWalk</td>
                                <td>@booking.Price</td>
                                <td>
                                    <a href="#deleteHotelBooking" data-toggle="modal" data-id="@booking.ID" class="btn btn-warning">Avboka</a>
                                </td>
                            </tr>
                        }
                    </tbody>


                    <!--HUND HALL BOKNINGAR -->
                    <thead>
                        <tr></tr>
                        <tr>
                            <th><h5>Träningshall</h5></th>
                        </tr>
                    </thead>
                    <thead>
                        <tr>
                            <th>Bokningsnummer</th>
                            <th>Starttid</th>
                            <th>Sluttid</th>
                            <th>Summa</th>
                            <th>Betalad</th>

                        </tr>
                    </thead>
                    <tbody>

                        @foreach (var booking in Model.TrainingHallBookings.Where(a => a.StartTime >= DateTime.Now))
                        {
                            <tr>
                                <th scope="row">@booking.ID</th>
                                <td>@booking.StartTime.ToString("yyyy-MM-dd HH:mm")</td>
                                <td>@booking.EndTime.ToString("yyyy-MM-dd HH:mm")</td>
                                <td>@booking.Price</td>
                                <td>@booking.Payed</td>
                                <td><a href="#deleteHallBooking" data-toggle="modal" data-id="@booking.ID" class="btn btn-warning">Avboka</a></td>

                            </tr>
                        }
                    </tbody>

                </table>
            </div>
        </div>
    </div>


    <div class="row" >
        <div class="col-md-12 mb-5">

            <div class="table-wrapper">
                <div class="table-title">
                    <div class="row">
                        <div class="col-sm-6">
                            <h2><b>Arkiverade bokningar</b></h2>
                        </div>
                        <div class="col-sm-6">
                        </div>
                    </div>
                </div>
                <table class="table table-striped table-hover" style="color:grey">



                    <!-- HUNDPENSIONAT BOKNINGAR -->
                    <thead>
                        <tr></tr>
                        <tr>
                            <th><h5>Hundpensionat</h5></th>
                        </tr>
                    </thead>
                    <thead>
                        <tr>
                            <th>Bokningsnummer</th>
                            <th>HundID</th>
                            <th>Från</th>
                            <th>Till</th>
                            <th>Meddelande</th>
                            <th>Träning</th>
                            <th>Grooming</th>
                            <th>Extra promenad</th>
                            <th>Summa</th>

                        </tr>
                    </thead>
                    <tbody>

                        @foreach (var booking in Model.HotelBookings.Where(a => a.To < DateTime.Now))
                        {
                            <tr>
                                <td>@booking.ID</td>
                                <td>@booking.DogID</td>
                                <td>@booking.From.ToString("yyyy-MM-dd HH:mm")</td>
                                <td>@booking.To.ToString("yyyy-MM-dd HH:mm")</td>
                                <td>@booking.CustomerMessage</td>
                                <td>@booking.Training</td>
                                <td>@booking.Grooming</td>
                                <td>@booking.ExtraWalk</td>
                                <td>@booking.Price</td>
                            </tr>
                        }
                    </tbody>
                    <br /><br />
                    <!--HUND HALL BOKNINGAR -->
                    <thead>
                        <tr></tr>
                        <tr>
                            <th><h5>Träningshall</h5></th>
                        </tr>
                    </thead>
                    <thead>
                        <tr>
                            <th>Bokningsnummer</th>
                            <th>Starttid</th>
                            <th>Sluttid</th>
                            <th>Summa</th>
                            <th>Betalad</th>

                        </tr>
                    </thead>
                    <tbody>

                        @foreach (var booking in Model.TrainingHallBookings.Where(a => a.StartTime < DateTime.Now))
                        {
                            <tr>
                                <th scope="row">@booking.ID</th>
                                <td>@booking.StartTime.ToString("yyyy-MM-dd HH:mm")</td>
                                <td>@booking.EndTime.ToString("yyyy-MM-dd HH:mm")</td>
                                <td>@booking.Price</td>
                                <td>@booking.Payed</td>
                            </tr>
                        }
                    </tbody>

                </table>
            </div>
        </div>
    </div>
</div>
@* NEW DOG MODAL *@
<div id="addDog" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Lägg till hund</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <form asp-controller="Customer" asp-action="AddDog" method="post">
                <div class="modal-body">
                    <label for="name">Namn</label>
                    <input class="form-control" id="name" placeholder="(obligatoriskt)" asp-for="Dog.Name" required />
                    <br />
                    <label for="name">Ras</label>
                    <input class="form-control" placeholder="(valfritt)" asp-for="Dog.Ras" />
                    <br />
                    <label for="name">Annat / allergier</label>
                    <textarea class="form-control" rows="3" asp-for="Dog.Other" placeholder="(valfritt)"></textarea>

                    <br />
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" style="transform:scale(1.5)" type="checkbox" id="otherdogs" asp-for="Dog.CanLiveWithOtherDogs">
                        <label class="form-check-label" for="otherdogs">Kan bo med andra</label>
                    </div><br /><br />

                    <div class="form-check form-check-inline">
                        <input required class="form-check-input" style="transform:scale(1.5)" type="radio" id="male" asp-for="Dog.Sex" value="Hane">
                        <label class="form-check-label" for="male">Hane</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input required style="transform:scale(1.5)" class="form-check-input" type="radio" id="female" asp-for="Dog.Sex" value="Tik">
                        <label class="form-check-label" for="female">Tik</label>
                    </div><br />
                    <div class="form-check form-check-inline">
                        <input required class="form-check-input" style="transform:scale(1.5)" type="radio" id="castrated" asp-for="Dog.Kastrated" value="true">
                        <label class="form-check-label" for="castrated">Kastrerad</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input required style="transform:scale(1.5)" class="form-check-input" type="radio" id="noCastrated" asp-for="Dog.Kastrated" value="false">
                        <label class="form-check-label" for="noCastrated">Ej kastrerad</label>
                    </div><br />
                </div>


                <div class="modal-footer">
                    <input type="submit" class="btn btn-success" value="Spara">
                </div>
            </form>
        </div>
    </div>
</div>



<!-- Delete dog MODAL-->
<div id="deleteCustomerDog" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form asp-controller="Customer" asp-action="RemoveDog">
                <div class="modal-header">
                    <h4 class="modal-title">Radera hund</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                </div>
                <div class="modal-body">
                    <p>Är du säker på att du vill radera denna hund från systemet?</p>
                    <p class="text-warning"><small>Bokningar som är kopplade till hunden kommer automatiskt att avbokas om det är minst 24 timmar kvar.</small></p>
                </div>
                <div class="modal-footer">
                    <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
                    <input type="submit" class="btn btn-danger" value="Ta bort">
                </div>
                <input type="hidden" class="deleteThis" name="id" />
            </form>
        </div>
    </div>
</div>


<!-- Delete training hall booking MODAL -->
<div id="deleteHallBooking" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form asp-controller="TrainingHall" asp-action="DeleteBooking">
                <div class="modal-header">
                    <h4 class="modal-title">Avboka bokning</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                </div>
                <div class="modal-body">
                    <p>Är du säker på att du vill avboka denna bokning?</p>
                    <p class="text-warning"><small>Detta går inte att ångra.</small></p>
                </div>
                <div class="modal-footer">
                    <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
                    <input type="submit" class="btn btn-danger" value="Avboka">
                </div>
                <input type="hidden" class="deleteThis" name="id" />
            </form>
        </div>
    </div>
</div>


<!-- Delete hotel booking MODAL-->
<div id="deleteHotelBooking" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form asp-controller="DogHotel" asp-action="DeleteBooking">
                <div class="modal-header">
                    <h4 class="modal-title">Avboka bokning</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                </div>
                <div class="modal-body">
                    <p>Är du säker på att du vill avboka denna bokning?</p>
                    <p class="text-warning"><small>Detta går inte att ångra.</small></p>
                </div>
                <div class="modal-footer">
                    <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
                    <input type="submit" class="btn btn-danger" value="Avboka">
                </div>
                <input type="hidden" class="deleteThis" name="id" />
            </form>
        </div>
    </div>
</div>


<!--SCRIPT -->
<script>
    $(document).ready(function () {

        $('a[data-toggle=modal], button[data-toggle=modal]').click(function () {

            var data_id = '';

            if (typeof $(this).data('id') !== 'undefined') {

                data_id = $(this).data('id');
            }

            $('.deleteThis').val(data_id);
        })
    });
</script>
